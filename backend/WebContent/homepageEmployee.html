<!DOCTYPE html>
<html>
<head>
    <title>Timesheet Management</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        body {
            height: 1000px;
            width: 1110px;
            margin: 10px;
            padding: 0;
            background-image: url('images/background1.jpg');
            background-size: 100%;
        }

        td {
            width: 50%;
            table-layout: fixed;
        }

        table {
            width: 500px;
            table-layout: fixed;
        }
    </style>
    <link href="tabcontent/template1/tabcontent.css" rel="stylesheet"
          type="text/css" />
    <script src="tabcontent/tabcontent.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>


    <script type="text/javascript">
        var serverIp = "localhost:8080";
        var mainContent;
        var loginData;

        function populateHeaderData(name, date, job) {
            document.getElementById('loggedUserName').innerHTML = name;
            document.getElementById('date').innerHTML = date;
            document.getElementById('loggedUserJob').innerHTML = job;
        }

        function getLoginDataFromServer() {
            console.log("request");
            $.ajax({
                type : "GET",
                url : "HomepageServlet",
                data : {
                    phase : "init"
                },
                success : function(data, textStatus, jqXHR) {
                    if (data.ok == true) {
                        loginData = data;
                        populateHeaderData(loginData.name, loginData.date, loginData.job);
                    }
                    else {
                        window.open('http://' + serverIp + '/TimesheetManagement/login.html', '_self', false);
                    }
                },
                error : function() {
                    alert("failure");
                    console.log('There is an error');
                }
            });
        }

        function endSession() {
            $.ajax({
                type: "GET",
                url: "HomepageServlet",
                data: {
                    phase: "done"
                },
                success : function(data, textStatus, jqXHR) {
                    window.open('http://' + serverIp + '/TimesheetManagement/login.html', '_self', false);
                },
                error : function() {
                    alert("failure");
                    console.log('There is an error');
                }
            })
        }

        function showAddDailyTimesheetScreen() {
            addTS = window.open('http://' + serverIp + '/TimesheetManagement/addDailyTimesheet.html',
                    'height=200,width=150', false);
            if (addTS.focus) {
                addTS.focus();
            }
        }

        function changePassword() {


        }

        $(document).ready(function() {
            getLoginDataFromServer();
            mainContent = document.getElementById('view_page').innerHTML;
            $('#settingsBtn').click(function() {
                //$('#view_page').load("settings.html #view_settings");
                $('#view_page').hide();
                $('#view_settings').show();
            });
            $('#homeBtn').click(function() {
                //document.getElementById('view_page').innerHTML = mainContent;
                $('#view_settings').hide();
                $('#view_page').show();
            });
            $('#logoutBtn').click(function() {
                endSession();
            });
        });
    </script>

</head>
<body>
<table style="width: 100%">
    <tr>
        <td align="left" style="width: 100%"><label>Current
            date: </label>
            <p id="date"></p></td>

        <td align="right" style="width: 100%"><label>You are
            logged in as: </label>
            <p id="loggedUserName"></p> <label>You work here as: </label>
            <p id="loggedUserJob"></p>

            <button id="homeBtn">Home</button>
            <button id="settingsBtn">Settings</button>
            <button id="logoutBtn">Logout</button></td>
    </tr>
</table>
<br>

<div id="view_page">
    <button id="addDailyTimesheet" onclick="showAddDailyTimesheetScreen()">Add
        daily timesheet</button>

    <br>
    <p>
        Last monthly timesheet status: <font color="blue">SUBMITTED
        (static)</font>
    </p>
    <p>Status of past monthly timesheets:</p>
    <table border="1" bgcolor="#5D7B9D" cellpadding="0" cellspacing="0">
        <tr>
            <td>Monthly timesheets<br>(date submitted)
            </td>
            <td>Status</td>
        </tr>
    </table>

    <div style="overflow: auto; height: 125px; width: 525px;">
        <table border="1" cellpadding="0" cellspacing="0">
            <tr>
                <td>August 2013 <br> 1.09.2013
                </td>
                <td>APPROVED</td>
            </tr>
            <tr>
                <td>September 2013 <br> 1.10.2013
                </td>
                <td>APPROVED</td>
            </tr>
            <tr>
                <td>October 2013 <br> 1.11.2013
                </td>
                <td><font color="blue"><u>SUBMITTED</u></font></td>
            </tr>
            <tr>
                <td>November 2013</td>
                <td><font color="blue"><u>OPEN</u></font></td>
            </tr>
        </table>
    </div>
</div>

<div id="view_settings" style="display: none">

    <br>
    <p><b><font color="red">Changing your password:</font></b></p>

    <form name="passwordForm" action="PasswordServlet" method="POST">
        <table>
            <tr>
                <td>Current password:</td>
                <td><input type="password" name="crtPassword"><br></td>
            </tr>
            <tr>
                <td>New password:</td>
                <td><input type="password" name="newPassword"><br></td>
            </tr>
            <tr>
                <td>Confirm new password:</td>
                <td><input type="password" name="confirmNewPassword"><br></td>
            </tr>
        </table>

        <br>

        <input type="submit" value="Save" disabled="disabled">

    </form>

</div>
</body>
</html>
